<head>
  <link rel="stylesheet" href="./src/index.css">
  <style> body { margin: 0; } </style>

  <script src="https://unpkg.com/3d-force-graph"></script>
  <!--<script src="../../dist/3d-force-graph.js"></script>-->
</head>

<body>
  <i>Disclaimer:</i>
  <i>This page is a modification of the
  <a href="https://vasturiano.github.io/3d-force-graph/example/img-nodes/">img-nodes example of vasturianos 3d-force-graph component</a> for testing and educational purposes.</i>
  <br>
  <div class="radio-toolbar">
    <input type="radio" id="color" name="sort" value="color" checked="checked">
    <label for="color">Sort By Color</label>
    <input type="radio" id="type" name="sort" value="type">
    <label for="type">Sort by Type</label>
    <input type="radio" id="date" name="sort" value="date">
    <label for="date">Sort by Date</label>
    <input type="radio" id="topic" name="sort" value="topic">
    <label for="topic">Sort by Topic</label>

    <input type="button" id="zoom" onclick="ZoomOut()">
    <label for="zoom">Zoom out</label>
  </div>
  <div id="3d-graph"></div>

  <script type="module">
    import * as THREE from 'https://unpkg.com/three/build/three.module.js';

    const imgs = ['cat.jpg', 'dog.jpg', 'eagle.jpg', 'elephant.jpg', 'grasshopper.jpg', 'octopus.jpg', 'owl.jpg', 'panda.jpg', 'squirrel.jpg', 'tiger.jpg', 'whale.jpg'];

    // Random connected graph
    const gData = {
      nodes: imgs.map((img, id) => ({ id, img })),
      links: [...Array(imgs.length).keys()]
        .filter(id => id)
        .map(id => ({
          source: id,
          target: Math.round(Math.random() * (id-1))
        }))
    };

    const hData = {
      nodes: imgs.map((img, id) => ({ id, img })),
      links: [...Array(imgs.length).keys()]
        .filter(id => id)
        .map(id => ({
          source: id,
          target: Math.round(Math.random() * (id-1))
        }))
    };

    const iData = {
      nodes: imgs.map((img, id) => ({ id, img })),
      links: [...Array(imgs.length).keys()]
        .filter(id => id)
        .map(id => ({
          source: id,
          target: Math.round(Math.random() * (id-1))
        }))
    };

    const jData = {
      nodes: imgs.map((img, id) => ({ id, img })),
      links: [...Array(imgs.length).keys()]
        .filter(id => id)
        .map(id => ({
          source: id,
          target: Math.round(Math.random() * (id-1))
        }))
    };

    const Graph = ForceGraph3D()
      (document.getElementById('3d-graph'))
      .nodeThreeObject(({ img }) => {
          const imgTexture = new THREE.TextureLoader().load(`./imgs/${img}`);
        imgTexture.colorSpace = THREE.SRGBColorSpace;
        const material = new THREE.SpriteMaterial({ map: imgTexture });
        const sprite = new THREE.Sprite(material);
        sprite.scale.set(12, 12);
        return sprite;
      })
      .graphData(gData)

     let rdBtn = document.querySelectorAll("input[name='sort']");
rdBtn.addEventListener("click", checkRd);

function checkRd(){
  if(rdBtn[0].checked == true){
Graph.graphData(gData);
}
else if(rdBtn[1].checked == true){
Graph.graphData(hData);
}
else if(rdBtn[2].checked == true){
Graph.graphData(iData);
}
else if(rdBtn[3].checked == true){
Graph.graphData(jData);
}
}
    let btn = document.getElementById("zoom");
  btn.onlick(() => Graph.zoomToFit(400)); //Optional // On button?
  // fit to canvas when engine stops
  //Graph.onEngineStop(() => Graph.zoomToFit(400));
      //.onNodeClick(node => { //Optional // On button?
      //    // Aim at node from outside it
      //    const distance = 40;
      //    const distRatio = 1 + distance/Math.hypot(node.x, node.y, node.z);
      //    const newPos = node.x || node.y || node.z
      //      ? { x: node.x * distRatio, y: node.y * distRatio, z: node.z * distRatio }
      //      : { x: 0, y: 0, z: distance }; // special case if node is in (0,0,0)
      //    Graph.cameraPosition(
      //      newPos, // new position
      //      node, // lookAt ({ x, y, z })
      //      3000  // ms transition duration
      //    );
      //  })
      ;
  </script>
</body>